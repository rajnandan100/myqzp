<!DOCTYPE html>
<html lang="en">
<head>
    <!-- QP-AUTH-META-002: Sign In Meta Tags -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Sign in to Quiz Portal - Access your dashboard and continue learning" />
    
    <title>Sign In - Quiz Portal</title>

    <!-- QP-AUTH-CDN-002: CDN Dependencies -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.1/dist/sweetalert2.min.css" />

    <!-- QP-AUTH-CSS-002: Custom CSS -->
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/auth.css" />
    <link rel="stylesheet" href="../css/mobile.css" />

    <!-- QP-CLERK-002: Clerk Authentication -->
    <script src="https://unpkg.com/@clerk/clerk-js@latest/dist/clerk.min.js"></script>
</head>
<body class="auth-body">
    <!-- QP-AUTH-NAV-002: Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-gradient-primary glass-nav">
        <div class="container">
            <a class="navbar-brand fw-bold fs-4" href="../index.html">
                <i class="fas fa-graduation-cap me-2 rotate-icon"></i>
                <span class="brand-text">Quiz Portal</span>
            </a>
            
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="sign-up.html">
                    <i class="fas fa-user-plus me-2"></i>Sign Up
                </a>
                <a class="nav-link" href="../index.html">
                    <i class="fas fa-home me-2"></i>Home
                </a>
            </div>
        </div>
    </nav>

    <!-- QP-AUTH-MAIN-002: Main Sign In Content -->
    <main class="auth-main">
        <div class="container">
            <div class="row justify-content-center align-items-center min-vh-100 py-5">
                <div class="col-lg-5 col-md-7 col-sm-9">
                    <!-- QP-AUTH-CARD-002: Sign In Card -->
                    <div class="auth-card glass-card" data-aos="zoom-in">
                        <div class="auth-header text-center mb-4">
                            <div class="auth-icon mb-3">
                                <i class="fas fa-sign-in-alt"></i>
                            </div>
                            <h2 class="h3 fw-bold">Welcome Back!</h2>
                            <p class="text-muted">Sign in to continue your learning journey</p>
                        </div>

                        <!-- QP-CLERK-SIGNIN-001: Clerk Sign In Component -->
                        <div id="clerk-sign-in"></div>

                        <!-- QP-AUTH-DIVIDER-002: Social Login Divider -->
                        <div class="auth-divider my-4">
                            <span class="auth-divider-text">Or sign in with email</span>
                        </div>

                        <!-- QP-AUTH-FALLBACK-002: Fallback Form -->
                        <form id="fallbackSignInForm" class="d-none">
                            <div class="mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-envelope text-primary me-2"></i>Email Address
                                </label>
                                <input type="email" class="form-control glass-input" id="email" required placeholder="Enter your email" autocomplete="email" />
                            </div>

                            <div class="mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <label class="form-label fw-semibold mb-0">
                                        <i class="fas fa-lock text-primary me-2"></i>Password
                                    </label>
                                    <a href="#" class="text-primary small" onclick="handleForgotPassword()">Forgot Password?</a>
                                </div>
                                <div class="password-input-group">
                                    <input type="password" class="form-control glass-input" id="password" required placeholder="Enter your password" autocomplete="current-password" />
                                    <button type="button" class="password-toggle" onclick="togglePassword('password')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="mb-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="rememberMe">
                                    <label class="form-check-label" for="rememberMe">
                                        Remember me for 30 days
                                    </label>
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary btn-lg w-100 glass-btn mb-3" id="signInBtn">
                                <i class="fas fa-sign-in-alt me-2"></i>Sign In
                                <div class="button-spinner d-none">
                                    <div class="spinner-border spinner-border-sm ms-2" role="status"></div>
                                </div>
                            </button>
                        </form>

                        <!-- QP-AUTH-FOOTER-002: Auth Footer Links -->
                        <div class="auth-footer text-center mt-4">
                            <p class="mb-3">
                                Don't have an account? 
                                <a href="sign-up.html" class="text-primary fw-semibold">Sign Up Free</a>
                            </p>

                            <!-- QP-DEMO-001: Demo Account -->
                            <div class="demo-account glass-card p-3 mt-4">
                                <h6 class="fw-bold mb-2">
                                    <i class="fas fa-eye text-info me-2"></i>Try Demo Account
                                </h6>
                                <button type="button" class="btn btn-outline-info btn-sm w-100" onclick="loginWithDemo()">
                                    <i class="fas fa-user-circle me-2"></i>Login as Demo User
                                </button>
                                <small class="text-muted d-block mt-2">No registration required</small>
                            </div>
                        </div>
                    </div>

                    <!-- QP-AUTH-FEATURES-001: Key Features -->
                    <div class="auth-features mt-4" data-aos="fade-up" data-aos-delay="200">
                        <div class="row g-3 text-center">
                            <div class="col-6">
                                <div class="feature-item glass-card p-3">
                                    <i class="fas fa-chart-line text-success fs-4 mb-2"></i>
                                    <small class="d-block fw-semibold">Track Progress</small>
                                    <small class="text-muted">Monitor your learning</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="feature-item glass-card p-3">
                                    <i class="fas fa-trophy text-warning fs-4 mb-2"></i>
                                    <small class="d-block fw-semibold">Compete</small>
                                    <small class="text-muted">Join leaderboards</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- QP-AUTH-SCRIPTS-002: Authentication Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.1/dist/sweetalert2.min.js"></script>
    <script src="../js/utils.js"></script>
    <script src="../js/clerk-auth.js"></script>

    <!-- QP-AUTH-INIT-002: Initialize Sign In -->
    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            once: true
        });

        // Initialize Clerk Sign In
        document.addEventListener('DOMContentLoaded', () => {
            if (window.ClerkAuth) {
                window.ClerkAuth.initSignIn();
            }
        });

        // QP-DEMO-002: Demo login functionality
        function loginWithDemo() {
            Swal.fire({
                title: 'Demo Account',
                text: 'Logging you in with demo credentials...',
                icon: 'info',
                timer: 2000,
                showConfirmButton: false
            }).then(() => {
                // Simulate demo login
                const demoUser = {
                    id: 'demo_user_123',
                    name: 'Demo User',
                    email: 'demo@quizportal.com',
                    avatar: null,
                    isDemo: true
                };
                
                // Store demo session
                window.QuizPortalUtils.setStorage('user_session', demoUser);
                window.QuizPortalUtils.setStorage('auth_token', 'demo_token_123');
                
                // Redirect to dashboard
                window.location.href = 'dashboard.html';
            });
        }

        // QP-FORGOT-001: Forgot password handler
        function handleForgotPassword() {
            Swal.fire({
                title: 'Reset Password',
                html: `
                    <p class="mb-3">Enter your email address and we'll send you a reset link.</p>
                    <input type="email" class="form-control glass-input" id="resetEmail" placeholder="Enter your email" required>
                `,
                showCancelButton: true,
                confirmButtonText: 'Send Reset Link',
                confirmButtonColor: '#6366f1',
                cancelButtonText: 'Cancel',
                preConfirm: () => {
                    const email = document.getElementById('resetEmail').value;
                    if (!email) {
                        Swal.showValidationMessage('Please enter your email address');
                        return false;
                    }
                    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                        Swal.showValidationMessage('Please enter a valid email address');
                        return false;
                    }
                    return email;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    // Simulate sending reset email
                    Swal.fire({
                        title: 'Reset Link Sent!',
                        text: `We've sent a password reset link to ${result.value}`,
                        icon: 'success'
                    });
                }
            });
        }
    </script>
</body>
</html>
